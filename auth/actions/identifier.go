package actions

//||------------------------------------------------------------------------------------------------||
//|| Import
//||------------------------------------------------------------------------------------------------||

import (
	"crypto/sha256"
	"encoding/base64"
	"fmt"

	"github.com/ralphferrara/aria/auth/setup"
)

//||------------------------------------------------------------------------------------------------||
//|| Generate an Email Hash
//||------------------------------------------------------------------------------------------------||

func GenerateIdentifierHash(identifier string) string {
	//||------------------------------------------------------------------------------------------------||
	//|| Get the Pepper
	//||------------------------------------------------------------------------------------------------||

	if !setup.Setup.Initialized {
		fmt.Println("[GenerateIdentifierHash] Auth setup is not initialized")
		return ""
	}

	//||------------------------------------------------------------------------------------------------||
	//|| Pepper
	//||------------------------------------------------------------------------------------------------||

	accountPepper := setup.Setup.Pepper
	if accountPepper == "" {
		fmt.Println("[GenerateIdentifierHash] ACCOUNT_PEPPER is not set")
		return ""
	}

	//||------------------------------------------------------------------------------------------------||
	//|| Create the Hash
	//||------------------------------------------------------------------------------------------------||

	idHash := sha256.Sum256([]byte(accountPepper + identifier))

	//||------------------------------------------------------------------------------------------------||
	//|| Return
	//||------------------------------------------------------------------------------------------------||

	return base64.StdEncoding.EncodeToString(idHash[:])
}
