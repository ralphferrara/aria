package actions

//||------------------------------------------------------------------------------------------------||
//|| Import
//||------------------------------------------------------------------------------------------------||

import (
	"crypto/sha256"
	"encoding/base64"
	"fmt"

	"github.com/ralphferrara/aria/auth"
)

//||------------------------------------------------------------------------------------------------||
//|| Generate an Email Hash
//||------------------------------------------------------------------------------------------------||

func GenerateEmailHash(email string) string {
	//||------------------------------------------------------------------------------------------------||
	//|| Get the Pepper
	//||------------------------------------------------------------------------------------------------||

	if !auth.Setup.Initialized {
		fmt.Println("[GenerateEmailHash] Auth setup is not initialized")
		return ""
	}

	//||------------------------------------------------------------------------------------------------||
	//|| Pepper
	//||------------------------------------------------------------------------------------------------||

	accountPepper := auth.Setup.Pepper
	if accountPepper == "" {
		fmt.Println("[GenerateEmailHash] ACCOUNT_PEPPER is not set") // Corrected log message
		return ""
	}

	//||------------------------------------------------------------------------------------------------||
	//|| Create the Hash
	//||------------------------------------------------------------------------------------------------||

	emailHash := sha256.Sum256([]byte(accountPepper + email))

	//||------------------------------------------------------------------------------------------------||
	//|| Return
	//||------------------------------------------------------------------------------------------------||

	return base64.StdEncoding.EncodeToString(emailHash[:])
}
